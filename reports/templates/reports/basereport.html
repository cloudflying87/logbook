{% extends 'logbook/base.html' %}


{% block content %}
{% include 'logbook/navbar.html' %}    
<h1>Report Page</h1>

<label for="report-select">Choose a Report:</label>

<select name="reports" id="report-select">
    <option value="">--Please choose an option--</option>
    <option value="totals">Totals</option>
    <option value="category">Category</option>
    <option value="lookup">Lookup</option>
    
</select>
<br>

<div id="display">


</div>

 <script>
  

document.addEventListener('input', function (event) {
  event.preventDefault()
  if (event.target.id === 'report-select'){
    if (event.target.value === 'totals') {
      url = "{% url 'totals' %}"
      $.ajax({                       
      url: url,  
      data: {
      },
      success: function (data) {   
        $("#display").html(data); 
      }
    });
    }
    if (event.target.value === 'lookup') {
      url = "{% url 'lookup' %}"
      $.ajax({                       
      url: url,  
      data: {
      },
      success: function (data) {   
        $("#display").html(data); 
      }
    });
    }

    if (event.target.value === 'category') {
      url = "{% url 'category' %}"
      $.ajax({                       
      url: url,  
      data: {
      },
      success: function (data) {   
        $("#display").html(data); 
      }
    });
    }
  
    
  }
    
  if (event.target.id === 'manufactureselect'){
    
    url = "{% url 'category' %}"
      $.ajax({                       
      url: url,  
      data: {
        "category":$("#manufactureselect").val()
      },
      success: function (data) {   
        $("#display").html(data); 
      }
    });
  }

  if (event.target.id === 'lookupselect'){
    if ($("#lookupselect").val() == 'airport'){
      
      selecturl = "{% url 'autocomplete' %}"
      $('#secondoption').select2({
            ajax: {
                url: selecturl,
                data: function (params) {
                    var query = {
                        q: params.term,
                    }
                return query;
                }
                
            }
          })
    }
  }

  $("#secondoption").on("select2:select", function (e){
    url = "{% url 'airportlookup' %}"
      $.ajax({                       
      url: url,  
      data: {
        "lookup": e.params.data,
        "option": "airport"
      },
      success: function (data) {   
        $("#lookupdiv").html(data); 
      }
    });
  })
  var count = 0
  count = count +1
  console.log(count)
  ,false});

  
  </script>
{% endblock%}